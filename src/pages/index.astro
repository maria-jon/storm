---
import { getCollection } from 'astro:content';
import type { CollectionEntry } from "astro:content";

import { SITE_DESCRIPTION, SITE_TITLE_TAG } from '../consts';
import BaseLayout from '../layouts/BaseLayout.astro';
import PageTitle from '../components/PageTitle.astro';
import PortfolioCard from '../components/PortfolioCard.astro';

import '../styles/index.css';

const posts = (await getCollection('portfolio'))

const sortPosts = (
  a: CollectionEntry<'portfolio'>,
  b: CollectionEntry<'portfolio'>
) => b.data.date.valueOf() - a.data.date.valueOf();

---
<style>
    h1 {
		color: var(--peachy-pink);
	}

    .portfolio-section {
       background-color: var(--peachy-pink);
       border-radius: var(--border-radius); 
       padding: var(--margin-md);
    }

    .portfolio-grid {
        list-style-type: none;
        margin-block-start: 0;
        margin-block-end: 0;
        padding-inline-start: 0;
        display: grid;
        grid-template-columns: repeat(1, 1fr);
        gap: var(--margin-md);
        width: 100%;
    }

    @media (min-width: 600px) {
        .portfolio-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: var(--margin-md);
        }
    }

    @media (min-width: 1024px) {
        .portfolio-grid {
            grid-template-columns: repeat(3, 1fr);
            gap: var(--margin-md);
        }
    }
</style>
<BaseLayout
	title={`Portfolio ${SITE_TITLE_TAG}`}
	description={SITE_DESCRIPTION}
    background="wine-red"
>
    <PageTitle 
        title="Portfolio"
        color="text-peachy-pink"
    />
    <div class="portfolio-section">
        <ul class="portfolio-grid">
			{
				posts
					.sort(sortPosts)
					.map((post) => (
						<PortfolioCard 
							cover={post.data.cover}
							coverAlt={post.data.coverAlt}
							url={`/portfolio/${post.id}/`}
							title={post.data.title}
                            class="grid-item"
						/>
					))
			}
		</ul>
    </div>

</BaseLayout>